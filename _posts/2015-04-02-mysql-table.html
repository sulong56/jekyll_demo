---
layout: default
title: MYSQL 数据表命令 外键 存储引擎 复制表 临时表 数据类型
description: mysql 数据表 建立 命令
keywords: 新建数据表 简单命令
category: mysql
tags: [mysql]
---

<div class="blog-header">
<h1 class="blog-title">MYSQL 数据表命令 外键 存储引擎 复制表 临时表 数据类型</h1>
<p class="lead blog-description">MYSQL中新建新建数据表,及一些其他简单命令</p>
<p class="blog-post-meta">{{ page.date | date:"%Y-%m-%d" }} by <a href="#">su</a></p>
</div>

<div class="row">

<div class="col-sm-12 blog-main">

  <div class="blog-post">
	<h2 class="blog-post-title">一、数据表</h2>

	<h3>1.基础</h3>

	<p class="MsoNormal" style="margin-left:0cm;text-indent:10.5pt;">数据表<span>(Table):</span>是数据库中最重要的组成部分，类似于二维表格，列称为字段(Field)，行称为记录(Record)。</p>

	<h3>2.常用命令</h3>

	<p class="MsoNormal" style="margin-left:0cm;text-indent:10.5pt;">查看数据表列表</p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>show tables;</code></p>

	<p class="MsoNormal" style="margin-left:0cm;text-indent:10.5pt;">查看数据表结构</p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>show columns from 表名;</code></p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>desc 表名;</code></p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>show create table 表名;</code></p>

	<p class="MsoNormal" style="margin-left:0cm;text-indent:10.5pt;">删除数据表</p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>DROP TABLE 表名;</code></p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;"><code>DROP TABLE IF EXISTS 表名;</code></p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;">说明：删除没有被关联的普通表：直接上面的SQL语句就行了。</p>
	<p class="MsoNormal" style="margin-left: 40px; text-indent: 10.5pt;">删除被其他表关联的父表：方法一：先删除子表，在删除父表; 方法二：删除父表的外键约束（上面有介绍），再删该表</p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">二、数据表新增，修改</h2>
	<h3>1.新增</h3>
	<p style="margin-left: 40px;">create table [if not exists] 数据表名称(</p>

	<p style="margin-left: 40px;">&nbsp; 列名称 数据类型 [[null | not null] | default 默认值 | auto_increment | [primary | unique key]],</p>

	<p style="margin-left: 40px;">&nbsp; .....</p>

	<p style="margin-left: 40px;">)</p>

	<p style="margin-left: 80px;">null : 允许为空</p>

	<p style="margin-left: 80px;">not null : 不允许为空</p>

	<p style="margin-left: 80px;"><strong>default:</strong></p>

	<p style="margin-left: 80px;">默认值,如果在插入记录时，没有为该字段赋值,系统将自动赋予该字段默认值。</p>

	<p style="margin-left: 80px;"><strong>auto_increment:</strong></p>

	<p style="margin-left: 80px;">自动编号,其数据类型为数值型(如果为浮点型，其数据类型应写为float(N,0)或double(N,0)),且该字段必须为定义为索引字段。</p>

	<p style="margin-left: 80px;"><strong>primary key:</strong></p>

	<p style="margin-left: 80px;">&nbsp; 主键约束,可以创建索引,一张数据表只能存在一个主键约束</p>

	<p style="margin-left: 80px;">&nbsp; 必须保证记录的唯一性,自动的禁止为空。</p>

	<p style="margin-left: 80px;"><strong>unique key:</strong></p>

	<p style="margin-left: 80px;">&nbsp; 必须保证记录的唯一性。</p>

	<p style="margin-left: 80px;">&nbsp; 唯一约束,可以创建索引,一张数据表可以存在多个唯一约束</p>

	<p style="margin-left: 40px;">说明:</p>

	<p style="margin-left: 40px;">A、在插入记录时，必须为禁止为空且没有默认值的字段赋值。</p>

	<p style="margin-left: 40px;">B、主键约束字段或唯一约束的字段都可以赋值。</p>

	<p style="margin-left: 40px;">C、一般情况下auto_increment与primary key组合使用。</p>

	<p style="margin-left: 40px;">D、自动编号的字段无需赋值。</p>

	<h3>2.修改</h3>
	<p style="margin-left: 40px;">数据表更名</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 rename [to] 新名称&nbsp;<br />
	rename table 旧名称 to 新名称,旧名称 to 新名称,...</code></p>

	<p style="margin-left: 40px;">添加单一字段</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 add [column] 列名称 列定义 [first|after 列名称]</code></p>

	<p style="margin-left: 40px;">添加多个字段</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 add [column] (列名称 列定义,...)</code></p>

	<p style="margin-left: 40px;">删除字段</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 drop [column] 列名称</code></p>

	<p style="margin-left: 40px;">添加/删除默认值</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 alter [column] 列名称 {set default 默认值 | drop default};</code></p>

	<p style="margin-left: 40px;">仅修改列定义</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 modify [column] 列名称 列定义 [first|after 列名称]</code></p>

	<p style="margin-left: 40px;">修改列定义及列名称</p>
	<p style="margin-left: 80px;"><code>alter table 数据表名称 change [column] 旧列名称 新列名称 列定义 [first|after 列名称]</code></p>

	<p style="margin-left: 40px;">修改字段的数据类型</p>
	<p style="margin-left: 80px;"><code>ALTER TABLE 表名 MODIFY 属性名 数据类型;</code></p>

	<p style="margin-left: 40px;">修改字段名</p>
	<p style="margin-left: 80px;"><code>ALTER TABLE 表名 CHANGE 旧属性名 新属性名 新数据类型;</code></p>

	<p style="margin-left: 40px;">更改表的存储引擎</p>
	<p style="margin-left: 80px;"><code>ALTER TABLE 表名 ENGINE = 存储引擎名;</code></p>

	<p style="margin-left: 40px;">修改表的字符集</p>
	<p style="margin-left: 80px;"><code>ALTER　TABLE 表名 CHARACTER SET UTF8;</code></p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">三、外键FOREIGN KEY </h2>
	<p style="margin-left: 40px;">表的外键约束可以在建表时设置也可以在建表完成后进行设置</p>
	<p style="margin-left: 40px;">外键约束可以将减少数据表的体积，提高查询速度。逻辑外键是指在设计数据表时，数据表的某个字段的值要引用其他数据表中某个字段的值。</p>
	<p style="margin-left: 40px;">所有tables必须是InnoDB型 ，它们不能是临时表。<br/>在引用表中，必须有一个索引，外键列以同样的顺序被列在其中作为第一列。这样一个索引如果不存在，它必须在引用表里被自动创建。<br/>在引用表中，必须有一个索引，被引用的列以同样的顺序被列在其中作为第一列。<br/>不支持对外键列的索引前缀。这样的后果之一是BLOB和TEXT列不被包括在一个外键中， 这是因为对这些列的索引必须总是包含一个前缀长度。</p>
	<h3>1.删除</h3>
	<p style="margin-left: 40px;">删除表的外键约束</p>
	<p style="margin-left: 80px;"><code>ALTER TABLE 表名 DROP FOREIGN KEY 外键别名;</code></p>

	<h3>2.新增</h3>
	<p style="margin-left: 40px;">建表时设置表的外键</p>
	<p style="margin-left: 80px;"><code>CONSTRAINT 外键别名 FOREIGN KEY(属性1,属性2,....属性n) REFERENCES 表名(属性1',属性2',...属性n')</code></p>

	<p style="margin-left: 40px;">建表完成后设置表的外键</p>
	<p style="margin-left: 80px;"><code>alter table 表名 add constraint FK_ID foreign key(你的外键字段名) REFERENCES 外表表名(对应的表的主键字段名);</code></p>
	<p style="margin-left: 80px;">例: <code>alter table tb_active add constraint FK_ID foreign key(user_id) REFERENCES tb_user(id)</code></p><br/>

	<div style="word-wrap: break-word; color: rgb(102, 102, 102); font-family: 宋体, Arial; font-size: 16px; line-height: 26px; widows: 1; margin-left: 40px;"><b style="word-wrap: break-word;">定义父表与子表直接的关系</b></div>

	<div style="word-wrap: break-word; color: rgb(102, 102, 102); font-family: 宋体, Arial; font-size: 16px; line-height: 26px; widows: 1;">
	<div style="word-wrap: break-word;">
	<div style="word-wrap: break-word; margin-left: 40px;">&nbsp;</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>CREATE TABLE `parent` (</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; `id` INT(11) NOT NULL,</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; PRIMARY KEY (`id`)</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>) ENGINE=INNODB DEFAULT CHARSET=utf8</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;">&nbsp;</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>CREATE TABLE `child` (</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; `id` INT(11) DEFAULT NULL,</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; `parent_id` INT(11) DEFAULT NULL,</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; KEY `par_ind` (`parent_id`),</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>&nbsp; CONSTRAINT `child_ibfk_1` FOREIGN KEY (`parent_id`) REFERENCES `parent` (`id`)&nbsp;<b style="word-wrap: break-word;">ON DELETE&nbsp;<font color="#f00000" style="word-wrap: break-word;">RESTRICT&nbsp;</font>ON UPDATE&nbsp;<font color="#f00000" style="word-wrap: break-word;">CASCADE</font></b></code></div>

	<div style="word-wrap: break-word; margin-left: 40px;"><code>) ENGINE=INNODB DEFAULT CHARSET=utf8</code></div>

	<div style="word-wrap: break-word; margin-left: 40px;">&nbsp;</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><b style="word-wrap: break-word;"><font color="#f00000" style="word-wrap: break-word;">CASCADE</font></b>：当父表发生DELETE或UPDATE操作时，相应子表中的数据也被DELETE或UPDATE</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><b style="word-wrap: break-word;"><font color="#f00000" style="word-wrap: break-word;">SET NULL</font></b>：当父表发生DELETE或UPDATE操作时，相应的子表中的数据被更新为NULL。当然子表中相应的列必须允许NULL值</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><b style="word-wrap: break-word;"><font color="#f00000" style="word-wrap: break-word;">ON ACTION</font></b>：当父表发生DELETE或UPDATE操作时，抛出错误，不允许这类操作发生</div>

	<div style="word-wrap: break-word; margin-left: 40px;"><font color="#f00000" style="word-wrap: break-word;"><b style="word-wrap: break-word;">RESTRICT</b></font>：当父表发生DELETE或UPDATE操作时，抛出错误，不允许这类操作发生.如果定义外键时没有指定ON DELETE或ON UPDATE,这就是默认的外键设置</div>
	</div>
	</div>

	<div style="word-wrap: break-word; color: rgb(102, 102, 102); font-family: 宋体, Arial; font-size: 16px; line-height: 26px; widows: 1;">&nbsp;</div>

	<p style="margin-left: 40px;">请注意，通过ON UPDATE 和 ON DELETE规则，设置MYSQL能够实现自动操作时，如果键的关系没有设置好，可能会导致严重的数据破坏，</p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">四、存储引擎</h2>
	<p style="margin-left: 40px;">存储引擎就是指表的类型，数据库存储引擎决定了表在计算机的存储方式。</p>
	<p style="margin-left: 40px;">MySQL 数据表主要支持六种类型 ，分别是：BDB、HEAP、ISAM、MERGE、MYISAM、InnoBDB。</p>
	<p style="margin-left: 40px;">这六种又分为两类，一类是“事务安全型”(transaction-safe)，包括BDB和InnoDB；其余都属于第二类，称为”非事务安全型”(non-transaction-safe)。</p>
	<p style="margin-left: 40px;">存储引擎说白了就是如何存储数据、如何为存储的数据建立索引和如何更新、查询数据等技术的实现方法。因为在关系数据库中数据的存储是以表的形式存储的，所以存储引擎也可以称为表类型（即存储和操作此表的类型）。</p>

	<br/><p style="margin-left: 40px;">InnoDB 是较新的事务安全型存储引擎，用于事务处理应用程序，支持BDB的几乎所有特性，并具有众多新特性，包括ACID事务支持。</p>
	<p style="margin-left: 40px;">特性：事务处理机制  支持外链  崩溃后能立即恢复  支持外键功能，级联删除  支持并发能力  在硬盘上的存储方式：InnoBDB frm</p>
	<p style="margin-left: 40px;">InnoDB是MySQL上第一个提供外键约束的表引擎，而且对事务处理的能力，也是其他存储引擎不能比拟的。不过这种引擎的缺点就是读写效率稍差，占用的数据空间相对比较大。</p>

	<br/><p style="margin-left: 40px;">MyISAM 默认的MySQL插件式存储引擎，它是基于ISAM类型，但它增加了许多有用的扩展，它是在Web、数据仓储和其他应用环境下最常使用的存储引擎之一。注意，通过更改STORAGE_ENGINE配置变量，能够方便地更改MySQL服务器的默认存储引擎。</p> 
	<p style="margin-left: 40px;">优点：1.比ISAM表更小，所占资源更少  2.可以在不同平台间二进制移植表的类型在创建表时指定。</p> 

	<br/><p style="margin-left: 40px;">MySQL中查询存储引擎的类型命令：</p>
	<p style="margin-left: 80px;"><code>SHOW ENGINES;</code></p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">五、复制表</h2>
	<p style="margin-left: 40px;">基于现有的表创建新表是一项很容易的任务。</p>
	<p style="margin-left: 40px;">以下代码将得到tb_test表的一个副本，名为tb_test2:</p>
	<p style="margin-left: 80px;"><code>create table tb_test2 select * from db_test.tb_test;</code></p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">六、临时表</h2>
	<p style="margin-left: 40px;">有的时候，当工作在非常大的表上时，可能偶尔需要运行很多查询获得一个大量数据的小的子集，不是对整个表运行这些查询，而是让MySQL每次找出所需的少数记录，将记录保存到一个临时表可能更快一些，然后对这些临时表进行查询操作。可以通过使用temporary关键字和create table语句来实现。</p>
	<p style="margin-left: 40px;">临时表的创建与其它表一样，只是它们存储在操作系统指定的临时目录中。临时表将在你连接MySQL期间存在，当你断开时，MySQL将自动删除表并释放所有的内存空间；当然了，你也可以手动的使用drop table命令删除临时表。</p>
	<p style="margin-left: 40px;">您必须拥有CREATE TEMPORARY TABLES权限，才能创建临时表。</p><br/>

	<p style="margin-left: 40px;">定义临时表举例</p>
	<p style="margin-left: 80px;"><code>  CREATE TEMPORARY TABLE tmp_table ( 
      name VARCHAR(10) NOT NULL, 
      value INTEGER NOT NULL 
	)</code></p>

	<p style="margin-left: 40px;">直接将查询结果导入临时表</p>
	<p style="margin-left: 80px;"><code>create temporary table 临时表名 select * from 检索的表;</code></p>

	<p style="margin-left: 40px;">另外mysql也允许你在内存中直接创建临时表，因为是在内存中所有速度会很快，语法如下</p>
	<p style="margin-left: 80px;"><code>  CREATE TEMPORARY TABLE tmp_table ( 
     name VARCHAR(10) NOT NULL, 
     value INTEGER NOT NULL 
	 ) TYPE = HEAP </code></p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">七、数据类型</h2>
	<p style="margin-left: 40px;">用于数据表字段的约束</p>
	<h3 style="margin-left: 40px;">1.整型</h3>

	<p style="margin-left: 40px;"><strong>tinyint [unsigned | zerofill],</strong><strong>占1字节:</strong></p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 无符号位的存储范围为0 ~ 255</p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 有符号位的存储范围为-128~127</p>

	<p style="margin-left: 40px;"><strong>smallint [unsigned | zerofill],</strong><strong>占2字节:</strong></p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 无符号位的存储范围为0 ~ 65535</p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 有符号位的存储范围为-32768 ~ 32767</p>

	<p style="margin-left: 40px;"><strong>mediumint [unsigned | zerofill],</strong><strong>占3字节:</strong></p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 无符号位的存储范围为0 ~ 16777215</p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 有符号位的存储范围为-8388608 ~ 8388607</p>

	<p style="margin-left: 40px;"><strong>int [unsigned | zerofill],</strong><strong>占4字节:</strong></p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 无符号位的存储范围为0 ~ 4294967295</p>

	<p style="margin-left: 40px;">&nbsp;&nbsp; 有符号位的存储范围为-2147483648 ~ 2147483647</p>

	<p style="margin-left: 40px;"><strong>bigint [unsigned | zerofill],</strong><strong>占8字节:</strong></p>

	<p style="margin-left: 40px;">boolean,等价于tinyint(1),0为假，其余为真。</p>

	<h3 style="margin-left: 40px;">2.浮点型</h3>

	<p style="margin-left: 40px;">float[(m[,p])][unsigned | zerofill], 3.4E38</p>

	<p style="margin-left: 40px;">double[(m[,p])][unsigned | zerofill], 1.79E308</p>

	<h3 style="margin-left: 40px;">3.字符型</h3>

	<p style="margin-left: 40px;">char(n),定长的字符,N的最大范围为255。</p>

	<p style="margin-left: 40px;">varchar(n),变长的字符,N的最大范围为65535。</p>

	<p style="margin-left: 40px;">tinytext,最多为255个字符</p>

	<p style="margin-left: 40px;">text,最多为65535个字符</p>

	<p style="margin-left: 40px;">mediumtext,最多为16777215个字符</p>

	<p style="margin-left: 40px;">enum:枚举,最多为65535个值。</p>
  </div>

  <div class="blog-post">
	<h2 class="blog-post-title">八、一段建表语句</h2>
	<div style="margin-left: 40px;"><code>CREATE TABLE order(</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;order_id &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;int(10) unsigned NOT NULL AUTO_INCREMENT,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;discount_price<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; decimal(10,2) NOT NULL DEFAULT 0.00,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;window<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; varchar(255) NOT NULL DEFAULT &#39;&#39;,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;discount_point<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; decimal(4,2) NOT NULL DEFAULT 1.00,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;order_price<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; decimal(10,2) NOT NULL DEFAULT 0.00,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;order_num<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; varchar(255) NOT NULL DEFAULT &#39;&#39;,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;card_num &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;varchar(255) NOT NULL DEFAULT 0,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;card_type &nbsp; &nbsp; &nbsp; &nbsp; tinyint(1) unsigned NOT NULL DEFAULT 0,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;merchant_id<span style="white-space:pre"><span style="white-space: normal;"> </span></span> &nbsp; int(10) NOT NULL DEFAULT 0,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;is_destory &nbsp; &nbsp; &nbsp; &nbsp;tinyint(1) unsigned NOT NULL DEFAULT 1,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;is_print &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;tinyint(1) unsigned NOT NULL DEFAULT 0,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;add_time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;datetime NOT NULL DEFAULT &#39;0000-00-00 00:00:00&#39;,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;print_time &nbsp; &nbsp; &nbsp; &nbsp;datetime NOT NULL DEFAULT &#39;0000-00-00 00:00:00&#39;,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;opeation &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;varchar(255) NOT NULL DEFAULT &#39;&#39;,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;is_rebates &nbsp; &nbsp; &nbsp; &nbsp;tinyint(1) unsigned NOT NULL DEFAULT 0,</code></div>

	<div style="margin-left: 40px;"><code>&nbsp;PRIMARY KEY (order_id)</code></div>

	<div style="margin-left: 40px;"><code>)ENGINE=InnoDB &nbsp;DEFAULT CHARSET=UTF8;</code></div>
  </div>
</div>
</div>

