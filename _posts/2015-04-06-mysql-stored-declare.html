---
layout: default
title: MYSQL 光标(游标)
description: mysql 光标(游标)
keywords: 光标 游标
category: mysql
tags: [mysql]
---

<div class="blog-header">
<h1 class="blog-title">MYSQL 光标(游标)</h1>
<p class="lead blog-description">光标(游标)的详细介绍</p>
<p class="blog-post-meta">{{ page.date | date:"%Y-%m-%d" }} by <a href="#">su</a></p>
</div>

<div class="row">

<div class="col-sm-12 blog-main">

<div class="blog-post">
	<h2 class="blog-post-title">光标的使用</h2>
	<p style="margin-left: 80px;">查询语句可能查询出多条记录，在存储过程和函数中使用光标来逐条读取查询结果集中的记录。有些书上将光标称为游标。光标的使用包括声明光标、打开光标、使用光标和关闭光标。光标必须声明在处理程序之前，并且声明在变量和条件之后。</p>
	<h3 class="blog-post-title">1 声明光标</h3>
	<p style="margin-left: 80px;">MySQL中使用DECLARE关键字来声明光标。其语法的基本形式如下：</p>
	<p style="margin-left: 80px;"><code>DECLARE cursor_name CURSOR FOR select_statement ;</code></p>
	<p style="margin-left: 80px;">其中，cursor_name参数表示光标的名称；select_statement参数表示SELECT语句的内容。</p>
	<p style="margin-left: 80px;"><strong>【示例】 下面声明一个名为cur_employee的光标。代码如下：</strong></p>
	<p style="margin-left: 80px;"><code>DECLARE cur_employee CURSOR FOR SELECT name, age FROM employee ;</code></p>
	<p style="margin-left: 80px;">上面的示例中，光标的名称为cur_employee；SELECT语句部分是从employee表中查询出name和age字段的值。</p>
	<h3 class="blog-post-title">2 打开光标</h3>
	<p style="margin-left: 80px;">MySQL中使用OPEN关键字来打开光标。其语法的基本形式如下：</p>
	<p style="margin-left: 80px;"><code>OPEN  cursor_name ;</code></p>
	<p style="margin-left: 80px;">其中，cursor_name参数表示光标的名称。</p>
	<p style="margin-left: 80px;"><strong>【示例】 下面打开一个名为cur_employee的光标，代码如下：</strong></p>
	<p style="margin-left: 80px;"><code>OPEN  cur_employee ;</code></p>
	<h3 class="blog-post-title">3 使用光标</h3>
	<p style="margin-left: 80px;">MySQL中使用FETCH关键字来使用光标。其语法的基本形式如下：</p>
	<p style="margin-left: 80px;"><code>FETCH cur_employee INTO var_name[,var_name…] ;</code></p>
	<p style="margin-left: 80px;">其中，cursor_name参数表示光标的名称；var_name参数表示将光标中的SELECT语句查询出来的信息存入该参数中。var_name必须在声明光标之前就定义好。</p>
	<p style="margin-left: 80px;"><strong>【示例】 下面使用一个名为cur_employee的光标。将查询出来的数据存入emp_name和emp_age这两个变量中，代码如下：</strong></p>
	<p style="margin-left: 80px;"><code>FETCH  cur_employee INTO emp_name, emp_age ;</code></p>
	<p style="margin-left: 80px;">上面的示例中，将光标cur_employee中SELECT语句查询出来的信息存入emp_name和emp_age中。emp_name和emp_age必须在前面已经定义。</p>
	<h3 class="blog-post-title">4 关闭光标</h3>
	<p style="margin-left: 80px;">MySQL中使用CLOSE关键字来关闭光标。其语法的基本形式如下：</p>
	<p style="margin-left: 80px;"><code>CLOSE  cursor_name ;</code></p>
	<p style="margin-left: 80px;">其中，cursor_name参数表示光标的名称。</p>
	<p style="margin-left: 80px;"><strong>【示例】 下面关闭一个名为cur_employee的光标。代码如下：</strong></p>
	<p style="margin-left: 80px;"><code>CLOSE  cur_employee ;</code></p>
	<p style="margin-left: 80px;">上面的示例中，关闭了这个名称为cur_employee的光标。关闭之后就不能使用FETCH来使用光标了。</p>
	<br/><p style="margin-left: 80px;">技巧：如果存储过程或函数中执行SELECT语句，并且SELECT语句会查询出多条记录。这种情况最好使用光标来逐条读取记录。光标必须在处理程序之前且在变量和条件之后声明。而且，光标使用完后一定要关闭。</p>
</div>


</div>
</div>


